"0","# Load necessary libraries"
"0","library(ggplot2)"
"0","library(readxl)"
"0","library(tidyr)"
"0",""
"0","# Replace with your data loading path if needed"
"0","data <- read_excel(""cleaned_annual_listing.xlsx"", sheet = ""Sheet1"")"
"0",""
"0","# Clean and select necessary columns"
"0","data <- data[3:nrow(data), c(1, 4, 5)]  # Adjust to skip header rows and select Year, Workers_Beginning, Workers_Effect"
"0","colnames(data) <- c(""Year"", ""Workers_Beginning"", ""Workers_Effect"")"
"0",""
"0","# Convert columns to appropriate types"
"0","data$Year <- as.integer(gsub(""\\D"", """", data$Year))"
"0","data$Workers_Beginning <- as.numeric(gsub("","", """", data$Workers_Beginning))"
"0","data$Workers_Effect <- as.numeric(gsub("","", """", data$Workers_Effect))"
"0",""
"0","# Reshape data for ggplot"
"0","data_long <- pivot_longer(data, cols = c(""Workers_Beginning"", ""Workers_Effect""), names_to = ""Status"", values_to = ""Workers"")"
"0",""
"0","# Plot the stacked area chart"
"0","ggplot(data_long, aes(x = Year, y = Workers, fill = Status)) +"
"0","  geom_area(alpha = 0.6) +"
"0","  labs(title = ""Comparison of Workers Involved at Beginning vs. In Effect"", "
"0","       x = ""Year"", "
"0","       y = ""Number of Workers (in thousands)"") +"
"0","  scale_fill_manual(values = c(""Workers_Beginning"" = ""blue"", ""Workers_Effect"" = ""green"")) +"
"0","  theme_minimal()"
"0",""
