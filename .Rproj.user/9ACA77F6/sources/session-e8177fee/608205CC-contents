---
title: "Labor Stats"
---

```{r}
library(plotly)
library(ggplot2)
```

```{r}
# Load necessary libraries
library(plotly)

# Import the dataset
data <- read.csv("education.csv", header = TRUE, stringsAsFactors = FALSE, na.strings = c("", "NA"))

# Ensure relevant columns are numeric and clean them
data$`Unemployment.rate....` <- as.numeric(gsub(",", "", as.character(data$`Unemployment.rate....`)))

# Check for NAs after conversion
na_count <- sum(is.na(data$`Unemployment.rate....`))
if (na_count > 0) {
  cat("Number of NA values in unemployment rate:", na_count, "\n")
}

# Filter out rows where unemployment rate is NA
filtered_data <- data[!is.na(data$`Unemployment.rate....`), ]

# Sort the data by unemployment rate from lowest to highest
filtered_data <- filtered_data[order(filtered_data$`Unemployment.rate....`), ]

# Check if the filtered data is empty
if (nrow(filtered_data) == 0) {
  stop("Filtered data is empty. Please check the dataset for valid unemployment rate values.")
}

# Create the scatter plot using Plotly
fig <- plot_ly(
  data = filtered_data,
  x = ~`Educational.attainment`,
  y = ~`Unemployment.rate....`,
  type = 'scatter',
  mode = 'markers',
  marker = list(
    color = ~`Unemployment.rate....`,  # Color based on unemployment rate
    colorscale = 'Reds',               # Color scale
    showscale = TRUE,                  # Show color scale
    size = 10                          # Size of the points
  )
) %>%
  layout(
    title = "Scatter Plot of Educational Attainment vs. Unemployment Rate",
    xaxis = list(title = "Educational Attainment"),
    yaxis = list(title = "Unemployment Rate (%)"),
    showlegend = FALSE
  )

# Show the plot
fig




```

